---
title: "ingerir"
author: "Fernanda Murillo"
date: "27/4/2021"
output: html_document
---

```{r setup, include=FALSE}
library(xlsx)
library(dplyr)
library(readxl)
library(tidyverse)

# Evitar warnings
options(warn=-1)
```


## IMPORTACIÓN DE DATOS

### READ CLIENTES CSV
```{r}
#CLIENTES
clientes<-read.csv("db/sqlclientes.csv", sep = ",", header = T)
head(clientes)
```

### READ PRODUCTOS XLSX
```{r}
#PRODUCTOS
productos<-read.xlsx("db/sqlproductos.xlsx", sheetIndex = 1)
names(productos)<-c("codigo","nombre","precio","utlidad")
attach(productos)
```

### READ VENTAS TSV
```{r}
#VENTAS
ventas<-read.table("db/sqlventas.tsv",sep = '\t', header = TRUE)
head(ventas, 1)
```


## ELIMINAR VALORES NULOS

### |PRODUCTOS|
```{r}
#PRODUCTOS
which(is.na(productos))
productos <- na.omit(productos) 
```

### |VENTAS|
```{r}
#VENTAS
which(is.na(ventas))
ventas <- na.omit(ventas)
```

### |CLIENTES|
```{r}
#CLIENTES
#which(is.na(clientes))
#clientes <- na.omit(clientes, 1) 
```


## VALORES ATÍPICOS

### |VENTAS|
```{r}
boxplot(ventas$MONTO)
boxplot(ventas$CONSECUTIVO)
```

### |PRODUCTOS|
```{r}
boxplot(productos$codigo)
boxplot(productos$precio)
boxplot(productos$utlidad)
```


## VALORES NO ATÍPICOS

### |PRODUCTOS|
```{r}
productos %>% filter(precio <= 95810) %>%
  summarise(mediana = median(precio))
```

### |VENTAS|
```{r}
ventas %>% filter(MONTO <= 155201) %>%
  summarise(mediana = median(MONTO))
```


## HISTOGRAMA DE LOS DATOS

### |PRODUCTOS|
```{r}
hist(productos$precio, freq = F, col = "pink")
lines(density(productos$precio), col="blue")
```

### |VENTAS|
```{r}
hist(ventas$MONTO, freq = F, col = "pink")
lines(density(ventas$MONTO), col="blue")
```


## TRATAMIENTO DE LOS VALORES ATÍPICOS

### |PRODUCTOS|
```{r}
outlayers <- function(productos,inferior,superior)
{
  data[data < inferior] <- mean(data)
  data[data > superior] <- median(data)
  data
}
```



### Para agregar la nueva columna con los datos tratados

```{r}
cproductos<-productos %>% mutate(ccodigo=outlayers(productos$codigo, 10, 95810))
head(cproductos)

boxplot(cproductos$ccodigo)
```

### Creación del modelo de regresión línea simple

```{r}
modelo<-lm(data = cproductos, codigo, nombre, utlidad~cprecio)
```

### Ver los estadísticos del modelo

```{r}
summary(lm_modelo)
```

### 

```{r}
cor.test(cproductos$cprecio,cproductos$cprecio)

plot(cproductos$cprecio$codigo,xlab = "precio",
     ylab = "codigo", main ="Prueba de la regresión lineal " )
abline(lm_modelo,col("blue"))

ggplot(cproductos)
```



